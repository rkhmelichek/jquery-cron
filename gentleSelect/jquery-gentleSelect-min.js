(function(c){function f(a){return"undefined"==typeof a?!1:!0}function s(a,b){return f(b.columns)&&f(b.rows)?(c.error("gentleSelect: you cannot supply both 'rows' and 'columns'"),!0):f(b.columns)&&!f(b.itemWidth)?(c.error("gentleSelect: 'itemWidth' must be supplied if 'columns' is specified"),!0):f(b.rows)&&!f(b.itemWidth)?(c.error("gentleSelect: 'itemWidth' must be supplied if 'rows' is specified"),!0):!f(b.openSpeed)||"number"!=typeof b.openSpeed&&"string"==typeof b.openSpeed&&"slow"!=b.openSpeed&&
"fast"!=b.openSpeed?(c.error('gentleSelect: \'openSpeed\' must be an integer or "slow" or "fast"'),!0):!f(b.closeSpeed)||"number"!=typeof b.closeSpeed&&"string"==typeof b.closeSpeed&&"slow"!=b.closeSpeed&&"fast"!=b.closeSpeed?(c.error('gentleSelect: \'closeSpeed\' must be an integer or "slow" or "fast"'),!0):!f(b.openEffect)||"fade"!=b.openEffect&&"slide"!=b.openEffect?(c.error('gentleSelect: \'openEffect\' must be either "fade" or "slide"'),!0):!f(b.closeEffect)||"fade"!=b.closeEffect&&"slide"!=
b.closeEffect?(c.error('gentleSelect: \'closeEffect\' must be either "fade" or "slide"'),!0):f(b.hideOnMouseOut)&&"boolean"==typeof b.hideOnMouseOut?!1:(c.error('gentleSelect: \'hideOnMouseOut\' must be supplied and either "true" or "false"'),!0)}function q(a,b,d){if(1>b.length)return d.prompt;0!=d.maxDisplay&&b.length>d.maxDisplay?(d=c.map(b.slice(0,d.maxDisplay),function(a,b){return c(a).text()}),b=!0):(d=c.map(b,function(a,b){return c(a).text()}),b=!1);d.sort(function(b,c){var d;a.find("option").each(function(a){if(this.text==
b)return d=Number(this.value),!1});var f;a.find("option").each(function(a){if(this.text==c)return f=Number(this.value),!1});return d-f});b&&d.push("...");return d.join("<br/>")}var t={minWidth:100,itemWidth:void 0,columns:void 0,rows:void 0,title:void 0,prompt:"Make A Selection",maxDisplay:0,openSpeed:400,closeSpeed:400,openEffect:"slide",closeEffect:"slide",hideOnMouseOut:!0},p={init:function(a){a=c.extend({},t,a);if(s(this,a))return this;this.hide();label_text=q(this,this.find(":selected"),a);var b=
c("<div class='gentleselect-label'>"+label_text+"</div>").insertBefore(this).bind("mouseenter.gentleselect",g.labelHoverIn).bind("mouseleave.gentleselect",g.labelHoverOut).bind("click.gentleselect",g.labelClick).data("root",this);this.data("label",b).data("options",a);var d=c("<ul></ul>");this.find("option").each(function(){var a=c("<li>"+c(this).text()+"</li>").data("value",c(this).attr("value")).data("name",c(this).text()).appendTo(d);c(this).attr("selected")&&a.addClass("selected")});var e=c("<div class='gentleselect-dialog'></div>").append(d).insertAfter(b).bind("click.gentleselect",
g.dialogClick).bind("mouseleave.gentleselect",g.dialogHoverOut).data("label",b).data("root",this);this.data("dialog",e);if(f(a.columns)||f(a.rows)){d.css("float","left").find("li").width(a.itemWidth).css("float","left");var h=d.find("li:first"),l=a.itemWidth+parseInt(h.css("padding-left"))+parseInt(h.css("padding-right")),h=d.find("li").length;if(f(a.columns))var m=parseInt(a.columns),k=Math.ceil(h/m);else k=parseInt(a.rows),m=Math.ceil(h/k);e.width(l*m);for(l=0;l<k*m-h;l++)c("<li style='float:left' class='gentleselect-dummy'><span>&nbsp;</span></li>").appendTo(d);
var r=[],n=0;d.find("li").each(function(){if(n<k)r[n]=c(this);else{var a=n%k;c(this).insertAfter(r[a]);r[a]=c(this)}n++})}else"number"==typeof a.minWidth&&e.css("min-width",a.minWidth);f(a.title)&&c("<div class='gentleselect-title'>"+a.title+"</div>").prependTo(e);c(document).bind("keyup.gentleselect",g.keyUp);c("html").click(function(){c(".gentleselect-dialog").hide()});e.click(g.hideInactive);b.click(g.hideInactive);this.find(":selected").length||(this.find("option").first().get(0).selected=!0,
p.update.call(this));return this},update:function(){var a=this.data("options"),b=this.attr("multiple")?this.val():[this.val()];c("li",this.data("dialog")).each(function(){var a=c(this),e=-1!=c.inArray(a.data("value"),b);a.toggleClass("selected",e)});a=q(this,this.find(":selected"),a);this.data("label").html(a);return this}},g={labelHoverIn:function(){c(this).addClass("gentleselect-label-highlight")},labelHoverOut:function(){c(this).removeClass("gentleselect-label-highlight")},labelClick:function(){var a=
c(this),b=a.position(),d=a.data("root"),e=d.data("options"),a=d.data("dialog").css("top",b.top+a.height()).css("left",b.left+1);"fade"==e.openEffect?a.fadeIn(e.openSpeed):a.slideDown(e.openSpeed);"none"!=a.attr("display")&&c.data(document.body,"activeDialog",a[0])},dialogHoverOut:function(){var a=c(this);a.data("root").data("options").hideOnMouseOut&&a.hide()},dialogClick:function(a){var b=c(a.target),d=c(this);a=d.data("root");var e=a.data("options");a.attr("multiple")||("fade"==e.closeEffect?d.fadeOut(e.closeSpeed):
d.slideUp(e.closeSpeed));if(b.is("li")&&!b.hasClass("gentleselect-dummy")){var f=b.data("value");b.data("name");var g=d.data("label");d.hide();e.readOnly||(d.data("root").attr("multiple")?(b.toggleClass("selected"),b=d.find("li.selected"),g.html(q(a,b,e)),e=b.map(function(){return c(this).data("value")}),a.val(e.get()).trigger("change")):(d.find("li.selected").removeClass("selected"),b.addClass("selected"),g.text(b.data("name")),a.val(f).trigger("change")))}},keyUp:function(a){27==a.keyCode&&c(".gentleselect-dialog").hide()},
hideInactive:function(a){var b=c.data(document.body,"activeDialog");a.currentTarget==b?(a.stopPropagation(),c(".gentleselect-dialog").each(function(b,e){"none"!=c(e).attr("display")&&e!=a.currentTarget&&c(e).hide()})):(a.stopPropagation(),c(".gentleselect-dialog").each(function(b,e){var f=c(e).parent().find(".gentleselect-label");"none"!=c(e).attr("display")&&f[0]!=a.currentTarget&&c(e).hide()}))}};c.fn.gentleSelect=function(a){if(p[a])return p[a].apply(this,Array.prototype.slice.call(arguments,1));
if("object"!==typeof a&&a)c.error("Method "+a+" does not exist on jQuery.gentleSelect");else return p.init.apply(this,arguments)}})(jQuery);
